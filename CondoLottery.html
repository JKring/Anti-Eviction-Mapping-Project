<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <!--Edit the title of the page-->
    <title>Your page title goes here</title>
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="http://libs.cartocdn.com/cartodb.js/v2/themes/css/cartodb.css" />
    <link rel="stylesheet" href="css/jquery-ui.min.css">
    <!--[if lte IE 8]>
      <link rel="stylesheet" href="http://libs.cartocdn.com/cartodb.js/v2/themes/css/cartodb.ie.css" />
    <![endif]-->
    <!--Switch between the different themes changing the stylesheet below - light-theme.css |dark-theme.css -->
    <link rel="stylesheet" href="css/light-theme.css">
    <link rel="stylesheet" href="css/makeitresponsive.css">
    <script src="http://libs.cartocdn.com/cartodb.js/v3/cartodb.js"></script>

  <script src="js/jquery.ui.core.js"></script>
  <script src="js/jquery.ui.widget.js"></script>
  <script src="js/jquery.ui.mouse.js"></script>
  <script src="js/jquery.ui.slider.js"></script>
  </head>
  <body>

    <div class="map" id="map"></div>

    <div class="sidepanel">
      <div class="wrapper">
        <div class="context subheader">
          <p>Map created by <a href="#">{Link to your website}</a></p>
        </div>
        <h1>SF EVICTED</h1>
        <p>The geography of evictions</p>
        <div id="slider"></div>
        <p id="year">2010</p>
        <!--Copy and paste the div below for creating content blocks-->
        <h3>Description</h3>
        <p>The size and age of the Cosmos are beyond ordinary human understanding. Lost somewhere between immensity and eternity is our tiny planetary home. In a cosmic perspective, most human concerns seem insignificant, even petty. And yet our species is young and curious and brave and shows much promise. In the last few millennia we have made the most astonishing, unexpected discoveries about the Cosmos and our place within it, explorations that are exhilarating to consider. They remind us that humans have evolved to wonder, that understanding is a joy, that knowledge is prerequisite to survival. I believe our future depends powerfully on how well we understand this Cosmos in which we float like a mote of dust in the morning sky.</p>

        <h3>Sources</h3>
        <p>Unexpected discoveries about the <a href="#">Cosmos and our place</a> within it, explorations that are <a href="#">exhilarating</a> to consider. They remind us that humans have evolved to wonder, that understanding is a joy, that knowledge is prerequisite to survival. I believe our future depends powerfully on how well we understand this.</p>

        <div class="context footer">
          <p>Create your maps with ease using <a href="http://cartodb.com">CartoDB</a></p></p>
        </div>
      </div>
    </div>

    <!--Change the URL below in order to change the map that is being shown.
    Go to your map in CartoDB, click on share, and copy the URL undert the API section
    Check the cartodb.js documentation for more info
    http://developers.cartodb.com/documentation/cartodb-js.html-->
    <script type="text/javascript">

    var sublayers = [];

     $(function() {
    $( "#slider" ).slider({ max: 2013, min:2000, change: function( event, ui ) {
       // alert("moved " + $( "#slider" ).slider( "value" ));
        updateMap( $( "#slider" ).slider( "value" ));
      }
     });
  });

  function updateMap(currYear){
    $("#year").html(currYear);
    sublayers[0].setSQL("SELECT * FROM condo_lottery_97_to_12 WHERE year < "+ currYear);

  }

  function main() {
        var map = L.map('map').setView([37.762193, -122.450218], 11);
         var numTables = 3;
         
       
    var mapboxUrl = 'https://dnv9my2eseobd.cloudfront.net/v3/cartodb.map-4xtxp73f/{z}/{x}/{y}.png';
    var mapbox = new L.TileLayer(mapboxUrl,{
         maxZoom:18,
         attribution:'Map imagery from Mapbox and &copy OpenStreetMap',
         subdomains:['a','b','c','d']
        });
     
    map.addLayer(mapbox);

   /* var url = 'http://ojack.cartodb.com/api/v2/viz/a8089c3e-ecbc-11e2-b14f-cf3d2e2a7b00/viz.json';
    var layers;

    cartodb.createVis('map', url)
  .done(function(vis, layers) {

   // layers = vis.getLayers();
    alert(layers.length);
     $('.button').click(function() {
        layers[1].hide();
          alert("clicked and hid sublayer");
    $('.button').removeClass('selected');
    $(this).addClass('selected');
   // LayerActions[$(this).attr('id')]();
  });
  });*/
   var condoLottery =   cartodb.createLayer(map, 'http://ojack.cartodb.com/api/v2/viz/e4e4ae8a-f659-11e2-b210-9768d5896611/viz.json').addTo(map)
         .on('done', function(layer) {

          var sublayer = layer.getSubLayer(0);
      sublayers.push(sublayer);
          
        }).on('error', function() {
          cartodb.log.log("some error occurred");
        });


       
       }

      // you could use $(window).load(main);
      window.onload = main;
    </script>

  </body>
      </html>
